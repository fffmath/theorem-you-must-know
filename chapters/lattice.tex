%% Lattice 

\chapter{Lattice Based Cryptography}
\section{The two definitions of lattice are equivalent}
\begin{definition}[Lattice]~\label{lattice1}
Given $n$ linearly independent vectors $\mathbf{b}_1, \ldots, \mathbf{b}_n \in \mathbb{R}^m$, the lattice generated by them is defined as
$$
\mathbb{L}(\mathbf{b}_1, \ldots, \mathbf{b}_n) = \left\{ \sum_{i=1}^{n} x_i \mathbf{b}_i \ \bigg| \ x_i \in \mathbb{Z} \right\}
$$
\end{definition}
\begin{definition}~\label{lattice2}
    A lattice $\mathbb{L}$ is a discrete additive subgroup of $\mathbb{R}^n$.
\end{definition}
\begin{theorem}
        The two definitions of lattice are equivalent.
\end{theorem}
\begin{proof}
    We will first show that Definition \ref*{lattice1} $\Rightarrow$ Definition \ref*{lattice2}.

    Assume $\mathbb{L}$ is a lattice defined as the set of all integer combinations of vectors $\mathbf{b}_1, \ldots, \mathbf{b}_n \in \mathbb{R}^m$ which are linearly independent (Definition 1). Then, clearly $L$ is an additive subgroup of $\mathbb{R}^n$. In addition, $\forall \mathbf{x}, \mathbf{y} \in L$, $\mathbf{x} - \mathbf{y} \in L$. Therefore, from the lower bound on a shortest lattice vector, 
    $$\|\mathbf{x} - \mathbf{y}\| \geq \lambda_1(\mathbb{L}) \geq \min_{i=1,\ldots,n} \|\tilde{\mathbf{b}}_i\|.$$
    In other words, the length of any lattice vector must be greater than the length of a shortest lattice vector.
    Therefore, we can let $\varepsilon = \lambda_1$. So, both properties of Definition 2 are satisfied ($L$ is a discrete additive subgroup of $\mathbb{R}^n$).
    
    We show that Definition \ref*{lattice2} $\Rightarrow$ Definition \ref*{lattice1}. Given a discrete additive subgroup $L$ of $\mathbb{R}^n$, we construct a set of basis using the algorithm below.
    
    We will use the following definition of a closed parallelepiped:
    
    Given \(n\) linearly independent vectors \(\mathbf{b}_1, \ldots, \mathbf{b}_n \in \mathbb{R}^m\), their closed fundamental parallelepiped is defined as
\[
\overline{P}(\mathbf{b}_1, \ldots, \mathbf{b}_n) = \left\{ \sum_{i=1}^{n} x_i \mathbf{b}_i \ \bigg| \ x_i \in \mathbb{R}, 0 \leq x_i \leq 1 \right\}
\]

Pick \(\mathbf{y} \in \mathbb{L}\) such that there is no lattice vector between the zero vector and \(\mathbf{y}\). Let \(\mathbf{b}_1 = \mathbf{y}\).
Iterate for all \(i\), \(1 \leq i < n\): Assume we have already chosen \(\mathbf{b}_1, \ldots, \mathbf{b}_i\). Choose \(\mathbf{y}\) not in the span of \(\mathbf{b}_1, \ldots, \mathbf{b}_i\).
Consider a \(\overline{P}(\mathbf{b}_1, \ldots, \mathbf{b}_i, \mathbf{y})\) (See Figure-1 for an example).
Now, \(\overline{P}\) contains at least one lattice point (namely \(\mathbf{y}\)) and it contains finitely many lattice points. Now, choose a vector \(\mathbf{z} \in \overline{P}(\mathbf{b}_1, \ldots, \mathbf{b}_i, \mathbf{y}) \setminus \text{Span}(\mathbf{b}_1, \ldots, \mathbf{b}_i)\) such that \(\text{dist}(\mathbf{z}, \text{Span}(\mathbf{b}_1, \ldots, \mathbf{b}_i))\) is the smallest.

Note that we can do this since we have only finitely many points to choose from. Let \(\mathbf{b}_{i+1} = \mathbf{z}\).

We will now show that the above algorithm returns a basis \(\mathbf{b}_1, \ldots, \mathbf{b}_n \in \mathbb{R}^m\) for the lattice. Clearly, all \(\mathbf{b}_i\)s are in \(\mathbb{R}^m\) and they are linearly independent by the algorithm that we used. We are left to show that \(L \subseteq \left\{ \sum x_i \mathbf{b}_i : x_i \in \mathbb{Z} \right\}\).

Let \(\mathbf{z} = \sum z_i \mathbf{b}_i\) be an arbitrary lattice vector (where \(z_i \in \mathbb{R}\)). Let \(\mathbf{z}_0 = \sum b_z^i \mathbf{c}_i\) be an element of \(L\). Then, \(\mathbf{z} - \mathbf{z}_0 = \sum (z_i - b_z^i c_i) \mathbf{b}_i\) is in \(L\). We will show that all coefficients \(z_i\) must be integers. Express 
$$
\mathbf{z} - \mathbf{z}_0 = (z_n - \lfloor z_n \rfloor) \mathbf{b}_n + \text{Span}(\mathbf{b}_1, \ldots, \mathbf{b}_{n-1}) = (z_n - \lfloor z_n \rfloor) \mathbf{b}_n + \text{Span}(\mathbf{b}_1, \ldots, \mathbf{b}_{n-1}).
$$
In other words, vector \(\mathbf{z} - \mathbf{z}_0\) is in the span of \(\mathbf{b}_1, \ldots, \mathbf{b}_{n-1}\) plus a multiple of \(\tilde{\mathbf{b}}_n\) with coefficients \(0 \leq b_z^n c_n < 1\).

Now,
\[
\text{dist}(\mathbf{z} - \mathbf{z}_0, \text{Span}(\mathbf{b}_1, \ldots, \mathbf{b}_{n-1})) = (z_n - \lfloor b_n \rfloor) \|\tilde{\mathbf{b}}_n\|.
\]
This follows because the distance is defined as the orthogonal component of \(\mathbf{z} - \mathbf{z}_0\) to the span \(\text{Span}(\mathbf{b}_1, \ldots, \mathbf{b}_{n-1})\), which is precisely \((z_n - b_z^n c_n) \|\tilde{\mathbf{b}}_n\|\). Similarly,
\[
\text{dist}(\mathbf{b}_n, \text{Span}(\mathbf{b}_1, \ldots, \mathbf{b}_{n-1})) = \|\tilde{\mathbf{b}}_n\|.
\]
In addition, since \(0 \leq (z_n - b_z^n c_n) < 1\),
\[
\text{dist}(\mathbf{z} - \mathbf{z}_0, \text{Span}(\mathbf{b}_1, \ldots, \mathbf{b}_{n-1})) < \text{dist}(\mathbf{b}_n, \text{Span}(\mathbf{b}_1, \ldots, \mathbf{b}_{n-1})).
\]
But since \(\mathbf{b}_n\) was chosen as the closest vector to \(\text{Span}(\mathbf{b}_1, \ldots, \mathbf{b}_{n-1})\), \(\mathbf{z} - \mathbf{z}_0\) must be linearly dependent on \(\mathbf{b}_1, \ldots, \mathbf{b}_{n-1}\). Therefore, \(z_n - \lfloor b_n \rfloor= 0\) and so \(z_n \in \mathbb{Z}\).

By recursively repeating the above argument for \(\mathbf{z} = \mathbf{z} - \mathbf{z}_i \in \text{Span}(\mathbf{b}_1, \ldots, \mathbf{b}_{i-1})\) for all \(1 < i \leq n\), we obtain that all coefficients \(z_j\) for \(1 \leq j \leq n\) must be integers.

\end{proof}